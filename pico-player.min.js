/**
 * pico-player.js v2.0
 * simple audio stream interface with Web Audio API, Audio Data API or HTMLAudioElement
 */this.pico=this.pico||{},function(a,b){a.Float32Array==null&&function(){function c(){}function b(a){var b,c;if(typeof a=="number"){a=a||0;if(a>0){this.length=a;while(a--)this[a]=0}}else if(a!=null&&typeof a.length=="number"){this.length=a.length;for(b=0,c=a.length;b<c;b++)this[b]=Number(a[b])}}console.warn("Float32Array are not defined, so use fake."),c.prototype=Array.prototype,b.prototype=new c,b.prototype.set=function(a,b){var c,d;b=b||0;for(c=0,d=a.length;c<d;c++)this[c+b]=a[c]},b.prototype.subarray=function(a,c){return new b(this.slice(a,c))},a.Float32Array=b}();var c=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c;return a.prototype},d=function(){var a=function(){},b=a.prototype;b.initplayer=function(a){var b,c,d,e,f;f=function(a){return Math.ceil(Math.log(a)*Math.LOG2E)},d=a.play_interval,e=2,this.SAMPLERATE=b=a.samplerate,this.CHANNEL=c=a.channel,this.STREAM_FULL_BITS=f(b*d/1e3),this.STREAM_FULL_SIZE=1<<this.STREAM_FULL_BITS,this.STREAM_CELL_BITS=f(b*e/1e3),this.STREAM_CELL_SIZE=1<<this.STREAM_CELL_BITS,this.STREAM_CELL_COUNT=this.STREAM_FULL_SIZE/this.STREAM_CELL_SIZE,this.NONE_STREAM_FULL_SIZE=new Float32Array(this.STREAM_FULL_SIZE),this.NONE_STREAM_FULL_SIZExC=new Float32Array(this.STREAM_FULL_SIZE*c),this.NONE_STREAM_CELL_SIZE=new Float32Array(this.STREAM_CELL_SIZE),this.NONE_STREAM_CELL_SIZExC=new Float32Array(this.STREAM_CELL_SIZE*c),this.PLAY_INTERVAL=this.STREAM_FULL_SIZE/b*1e3,this.finished=!0,this._generator=null},b.isPlaying=function(){return!this.finished};return a}(),e=function(){var a=function(){this.initialize.apply(this,arguments)},b=c(a,d);b.initialize=function(a){var b,c;b=new webkitAudioContext,a.samplerate=b.sampleRate,this.initplayer(a),c=b.createJavaScriptNode(this.STREAM_FULL_SIZE,1,this.CHANNEL),this._context=b,this._node=c},b.play=function(a){var b;this.finished&&(this._generator=a,this.finished=!1,this.CHANNEL==2?b=function(b){var c,d,e,f,g;c=a.next(),d=b.outputBuffer.getChannelData(0),e=b.outputBuffer.getChannelData(1),f=d.length,g=f<<1;while(f--)g-=2,d[f]=c[g],e[f]=c[g+1]}:b=function(b){var c,d,e,f;c=a.next(),d=b.outputBuffer.getChannelData(0),e=b.outputBuffer.getChannelData(1),f=d.length;while(f--)d[f]=e[f]=c[f]},this._node.onaudioprocess=b,this._node.connect(this._context.destination))},b.stop=function(){this._node.disconnect(),this.finished=!0},b.__defineGetter__("core",function(){return{context:this._context,node:this._node}}),b.__defineGetter__("PLAYER_TYPE",function(){return a.PLAYER_TYPE}),a.__defineGetter__("PLAYER_TYPE",function(){return"WebkitPlayer"});return a}(),f=function(){var a=function(){},b=c(a,d);b.inittimer=function(){var a=this,b=function(){var a,b,c;a=window.WebkitBlobBuilder||window.MozBlobBuilder,b=window.URL||window.webkitURL;if(a&&b){c=new a,c.append("var timerId = 0;"),c.append("this.onmessage = function(e) {"),c.append("  if (timerId !== 0) {"),c.append("    clearInterval(timerId);"),c.append("    timerId = 0;"),c.append("  }"),c.append("  if (e.data > 0) {"),c.append("    timerId = setInterval(function() {"),c.append("    postMessage(null);"),c.append("    }, e.data);"),c.append("  }"),c.append("};");return b.createObjectURL(c.getBlob())}return null}();this._timer=null;if(b!==null)try{this._timer=new Worker(b),this._timer.onmessage=function(b){a.play_impl()}}catch(c){console.warn("WebWorker is dead.")}this._timerId=0},b.play=function(a){var b=this;this.finished&&(this.finished=!1,this._generator=a,this._timer?this._timer.postMessage(this.PLAY_INTERVAL):(this._timerId!==0&&(clearInterval(this._timerId),this._timerId=0),this._timerId=setInterval(function(){b.play_impl()},this.PLAY_INTERVAL)))},b.stop=function(){this._timer?this._timer.postMessage(0):this._timerId!==0&&(clearInterval(this._timerId),this._timerId=0),this.finished=!0};return a}(),g=function(){var a=function(){this.initialize.apply(this,arguments)},b=c(a,f);b.initialize=function(a){var b,c;b=this,c=new Audio,c.mozSetup(a.channel,a.samplerate),a.samplerate=c.mozSampleRate,a.channel=c.mozChannels,this.initplayer(a),this.inittimer(),this._audio=c,this._stream=this.NONE_STREAM_FULL_SIZExC},b.play_impl=function(){this._audio.mozWriteAudio(this._stream),this._stream=this._generator.next()},b.__defineGetter__("core",function(){return{audio:this._audio}}),b.__defineGetter__("PLAYER_TYPE",function(){return a.PLAYER_TYPE}),a.__defineGetter__("PLAYER_TYPE",function(){return"MozPlayer"});return a}(),h=function(){var a=function(){this.initialize.apply(this,arguments)},b=c(a,f);b.initialize=function(a){var b;this.initplayer(a),this.inittimer(),this._stream=new Audio,this._stream_size=this.STREAM_FULL_SIZE*this.CHANNEL,this._waveheader=function(a,b,c){var d,e,f;f=c*b*2,d=f-8,e=d-36;return String.fromCharCode(82,73,70,70,d>>0&255,d>>8&255,d>>16&255,d>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,b,0,a>>0&255,a>>8&255,a>>16&255,a>>24&255,a*b*2>>0&255,a*b*2>>8&255,a*b*2>>16&255,a*b*2>>24&255,2*b,0,16,0,100,97,116,97,e>>0&255,e>>8&255,e>>16&255,e>>24&255)}(this.SAMPLERATE,this.CHANNEL,this.STREAM_FULL_SIZE)},b.play_impl=function(){var a,b,c,d,e,f;this._stream.play(),a=this._generator.next(),b=this._waveheader,f=String.fromCharCode;for(c=0,d=a.length;c<d;c++)e=a[c]*32767|0,b+=f(e&255,e>>8&255);this._stream=new Audio("data:audio/wav;base64,"+btoa(b))},b.__defineGetter__("core",function(){return{}}),b.__defineGetter__("PLAYER_TYPE",function(){return a.PLAYER_TYPE}),a.__defineGetter__("PLAYER_TYPE",function(){return"DynamicWavPlayer"});return a}(),i=function(){var a=function(){this.initialize.apply(this,arguments)},b=c(a,f);b.initialize=function(a){this.initplayer(a),this.inittimer()},b.play_impl=function(){this._generator.next()},b.__defineGetter__("core",function(){return{}}),b.__defineGetter__("PLAYER_TYPE",function(){return a.PLAYER_TYPE}),a.__defineGetter__("PLAYER_TYPE",function(){return"NopPlayer"});return a}();b.getplayer=function(){var b=function(){var b,c;b=typeof webkitAudioContext;if(b==="function"||b==="object")return e;b=typeof Audio;if(b==="function"||b==="object"){c=new Audio,b=typeof c.mozSetup;if(b==="function"||b==="object")return g;if(a.navigator.userAgent.indexOf("Opera")!==-1)return h}return i}();return function(a){var c;a=a||{},[8e3,11025,12e3,16e3,22050,32e3,44100,48e3].some(function(b){return b===a.samplerate})||(a.samplerate=44100),a.channel!==1&&a.channel!==2&&(a.channel=1),c=b,c.PLAYER_TYPE===e.PLAYER_TYPE?a.play_interval=25:c.PLAYER_TYPE===g.PLAYER_TYPE?a.play_interval=25:c.PLAYER_TYPE===h.PLAYER_TYPE?a.realtime?(a.play_interval=40,c=i):a.play_interval=200:c.PLAYER_TYPE===i.PLAYER_TYPE&&(a.play_interval=40);return new c(a)}}()}(this,this.pico)